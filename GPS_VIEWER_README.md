# GPS Animal Movement Viewer

A Python GUI application for visualizing GPS tracking data from Movebank with satellite imagery overlay from Google Earth Engine.

## Features

- **Interactive Map Visualization**: View animal GPS tracks on various base maps including:
  - OpenStreetMap
  - Satellite imagery (Esri)
  - Terrain maps
  - Google Earth Engine satellite imagery (requires authentication)

- **Animal Selection**: Choose from multiple animals in your dataset

- **Date Range Filtering**: Filter GPS data by custom date ranges

- **Multiple Visualization Modes**:
  - GPS track lines
  - Point markers with popup information
  - Heat maps showing movement density
  - Start/End markers

- **Movement Timeline**: Real-time plots showing:
  - Latitude changes over time
  - Longitude changes over time
  - Speed/movement metrics

- **Statistics Panel**: View key metrics including:
  - Total GPS points
  - Date range
  - Bounding box coordinates
  - Speed statistics

- **Animation Controls**: Play through GPS tracks with adjustable speed

## Installation

### 1. Install Required Packages

```bash
pip install -r requirements_gps_viewer.txt
```

Or install manually:

```bash
pip install pandas numpy matplotlib folium earthengine-api
```

### 2. (Optional) Setup Google Earth Engine

For satellite imagery from Google Earth Engine:

```bash
earthengine authenticate
```

This will open a browser window for authentication. Follow the instructions to authorize access.

**Note:** If you don't setup Google Earth Engine, the application will still work using other satellite imagery sources (Esri).

## Usage

### Basic Usage

```bash
python gps_viewer.py
```

This will load GPS data from the default `movebank_data` directory.

### Custom Data Directory

```bash
python gps_viewer.py path/to/your/data
```

## Required Data Files

The application expects the following files in your data directory:

- `events_gps.csv` - GPS tracking data (required)
- `individuals.csv` - Animal metadata (optional)

These files are generated by the `fetch_movebank_data.py` script.

## How to Use the Application

1. **Select an Animal**: Choose from the dropdown list
   - The date range will auto-populate with available data

2. **Adjust Date Range** (optional):
   - Modify start/end dates to focus on specific time periods
   - Format: YYYY-MM-DD

3. **Choose Base Map**:
   - OpenStreetMap: Standard street map
   - Satellite (Esri): High-resolution satellite imagery
   - Satellite (GEE): Google Earth Engine imagery (requires authentication)
   - Terrain: Topographic terrain map

4. **Select Visualization Options**:
   - Show Track Line: Display connected GPS points as a line
   - Show Point Markers: Display individual GPS points (clickable)
   - Show Heat Map: Display density heat map of locations

5. **Generate Map**: Click to create the interactive map
   - The map will automatically open in your default web browser
   - You can pan, zoom, and click on markers for details

6. **View Timeline**:
   - The right panel shows movement over time
   - Latitude, longitude, and speed plots

7. **Check Statistics**:
   - The stats panel shows summary information
   - Bounding box, date range, speed metrics

8. **Animation** (experimental):
   - Use Play/Pause to animate through the track
   - Adjust speed slider for animation speed

## Example Workflow

```python
# 1. First, fetch your Movebank data
python fetch_movebank_data.py --sensors gps --start 2024-01-01 --end 2024-12-31

# 2. Launch the GPS Viewer
python gps_viewer.py

# 3. In the GUI:
#    - Select an animal from dropdown
#    - Choose "Satellite (Esri)" as base map
#    - Check all visualization options
#    - Click "Generate Map"
#    - View interactive map in browser
```

## Map Interactions

The generated map is fully interactive:

- **Zoom**: Use mouse wheel or +/- buttons
- **Pan**: Click and drag
- **Markers**: Click on red dots for timestamp, coordinates, and speed
- **Track**: Hover over blue line to see track information
- **Start/End**: Green marker = start, Red marker = end

## Tips

1. **Large Datasets**: If you have many GPS points (>500), the app automatically samples points for markers to improve performance

2. **Multiple Animals**: Compare different animals by generating separate maps

3. **Date Filtering**: Use date filtering to focus on specific migration periods or behaviors

4. **Export**: The generated HTML maps can be saved and shared (File > Save in browser)

5. **Satellite Imagery**:
   - Esri satellite works without authentication
   - GEE satellite provides more recent imagery but requires setup

## Troubleshooting

### "GPS data file not found"
- Ensure you've run `fetch_movebank_data.py` first
- Check that `movebank_data/events_gps.csv` exists

### "No data to display"
- Check your date range filters
- Verify the selected animal has GPS coordinates in the data

### Google Earth Engine errors
- Run `earthengine authenticate` to setup credentials
- If authentication fails, use "Satellite (Esri)" instead

### Map doesn't open
- Check your default web browser settings
- The map file is saved in your temp directory
- Use "Open in Browser" button to manually open

## Data Requirements

The GPS data CSV should contain these columns:
- `individual_local_identifier`: Animal ID
- `timestamp`: Date/time of GPS fix
- `location_lat`: Latitude
- `location_long`: Longitude
- `ground_speed`: Speed (optional, for speed plots)

## Performance Notes

- Loading large datasets may take a few seconds
- Generating maps with heat maps is slower than simple tracks
- Browser performance depends on number of markers displayed

## Future Enhancements

Potential features for future versions:
- Export statistics to CSV
- Compare multiple animals on same map
- 3D elevation visualization
- Path prediction/interpolation
- Integration with environmental data layers

## Credits

Built with:
- **Folium**: Interactive maps
- **Matplotlib**: Timeline visualization
- **Pandas**: Data processing
- **Google Earth Engine**: Satellite imagery
- **Tkinter**: GUI framework

## License

This tool is provided as-is for research and educational purposes.
